import { motion } from "framer-motion";
import { useMemo } from "react";

export default function Overlay({
  loadingPercent,
}: {
  loadingPercent: number;
}) {
  // Tổng chiều dài path, đo bằng SVG editor hoặc DevTools
  const pathLength = 21848;

  // Tính toán strokeDashoffset dựa trên loadingPercent
  const dashOffset = useMemo(
    () => pathLength * (1 - loadingPercent / 100),
    [loadingPercent, pathLength]
  );

  return (
    <motion.div
      className="overlay font-1ftv text-small md:text-medium lg:text-huge"
      initial={{ y: 0 }}
      animate={{ y: loadingPercent >= 100 ? "-100%" : 0 }}
      transition={{ delay: 1, type: "spring", stiffness: 80, damping: 20 }}
    >
      <svg
        style={{
          shapeRendering: "geometricPrecision",
          textRendering: "geometricPrecision",
          fillRule: "evenodd",
          clipRule: "evenodd",
          position: "relative",
        }}
        viewBox="4820.47 7160.91 2353.32 2679.24"
      >
        <g id="Layer_x0020_1">
          {/* Path nền (fill) chuyển màu khi loading xong */}
          <motion.path
            className="fil0"
            animate={{ fill: loadingPercent >= 100 ? "#fff" : "#A02B2D" }}
            transition={{ duration: 0.8, ease: "easeInOut" }}
            fill="#A02B2D"
            d="M4889.4 8558.07c26.5,-58.19 -10.24,-1102.12 8.46,-1285.53 37.97,46.92 121.55,243.98 157.81,315.6l461.47 945.02c14.66,22.27 8.06,11.92 16.36,19.21 19.51,-20.94 25.65,-30.86 45.41,-44.8 16.39,-11.56 16.2,-9.35 29.24,-15.66l32.94 -20.5c-42.07,-73.1 -48.5,-67.97 -12.44,-149.53 107.06,-242.08 213.89,-519.99 318.58,-751.54 23.22,-51.35 39.96,-94.64 62.25,-146.25 12.39,-28.71 20.84,-49.01 32.86,-76.82 11.7,-27.09 18.37,-53.37 37.71,-74.45l1.92 1572.38c-278.28,58.97 -794.7,301.35 -1148.01,35.35 -126.22,-95.03 -62.48,-97.85 -113.49,-88.24 7.68,62.69 160.07,152.59 222.71,178.66 374.22,155.75 737.17,-29.35 1035.31,-99.26l3.41 965.27 133.03 3.17 2.46 -1003.44c73.8,-39.62 320.94,-59.72 422.01,-53.11 138.21,9.06 271.53,60.84 359.29,127.75 55.05,41.98 37.49,77.64 37.49,195.1 0,169.68 -10.03,622.32 2.7,732.77l134.87 0.21 0.04 -1708.95 -132.63 -0.38c-21.2,95.26 7.72,606.56 -6.23,772.1 -17.92,-5.56 -86.39,-60 -155.44,-89.03 -65.51,-27.54 -132.67,-45.85 -208.8,-53.18 -238.48,-22.96 -354.84,39.2 -450.81,41.36l-0.82 -1640.14 -123.12 0.45 -508.12 1191c-6.15,-5.58 -559.71,-1107.8 -585.72,-1191.49l-161.94 -0.26c22.71,76.49 32,45.68 31.19,149.23l-0.41 1088.7c-0.01,73.07 -13.69,149.23 18.46,159.23z"
          />
          {/* Path loading (stroke) animate theo loadingPercent */}
          <motion.path
            d="M4889.4 8558.07c26.5,-58.19 -10.24,-1102.12 8.46,-1285.53 37.97,46.92 121.55,243.98 157.81,315.6l461.47 945.02c14.66,22.27 8.06,11.92 16.36,19.21 19.51,-20.94 25.65,-30.86 45.41,-44.8 16.39,-11.56 16.2,-9.35 29.24,-15.66l32.94 -20.5c-42.07,-73.1 -48.5,-67.97 -12.44,-149.53 107.06,-242.08 213.89,-519.99 318.58,-751.54 23.22,-51.35 39.96,-94.64 62.25,-146.25 12.39,-28.71 20.84,-49.01 32.86,-76.82 11.7,-27.09 18.37,-53.37 37.71,-74.45l1.92 1572.38c-278.28,58.97 -794.7,301.35 -1148.01,35.35 -126.22,-95.03 -62.48,-97.85 -113.49,-88.24 7.68,62.69 160.07,152.59 222.71,178.66 374.22,155.75 737.17,-29.35 1035.31,-99.26l3.41 965.27 133.03 3.17 2.46 -1003.44c73.8,-39.62 320.94,-59.72 422.01,-53.11 138.21,9.06 271.53,60.84 359.29,127.75 55.05,41.98 37.49,77.64 37.49,195.1 0,169.68 -10.03,622.32 2.7,732.77l134.87 0.21 0.04 -1708.95 -132.63 -0.38c-21.2,95.26 7.72,606.56 -6.23,772.1 -17.92,-5.56 -86.39,-60 -155.44,-89.03 -65.51,-27.54 -132.67,-45.85 -208.8,-53.18 -238.48,-22.96 -354.84,39.2 -450.81,41.36l-0.82 -1640.14 -123.12 0.45 -508.12 1191c-6.15,-5.58 -559.71,-1107.8 -585.72,-1191.49l-161.94 -0.26c22.71,76.49 32,45.68 31.19,149.23l-0.41 1088.7c-0.01,73.07 -13.69,149.23 18.46,159.23z"
            fill="none"
            stroke="#fff"
            strokeWidth={10}
            strokeDasharray={pathLength}
            strokeDashoffset={dashOffset}
            style={{ transition: "stroke-dashoffset 0.5s linear" }}
          />
        </g>
      </svg>
    </motion.div>
  );
}
